<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Job Requests â€“ WorkConnect</title>

<style>
body { margin:0; font-family:'Poppins',sans-serif; background:#0a0e27; color:#fff; }
.header { background:hsl(233, 56%, 16%); padding:18px 25px; font-size:22px; font-weight:600; text-align:center; box-shadow:0 4px 15px rgba(0,0,0,0.4); }
.container { padding:25px; }
.job-card { background:#1c2450; padding:16px; border-radius:12px; margin-bottom:14px; }
.job-title { font-weight:600; font-size:16px; }
.job-info { font-size:14px; color:#b9c7df; margin-top:4px; }
.accept-btn, .reject-btn { margin-top:10px; background:#4da3ff; border:none; padding:10px; border-radius:10px; width:48%; color:#fff; cursor:pointer; transition:0.3s; }
.reject-btn { background:#e04e4e; float:right; }
.accept-btn:hover { background:#2274d4; }
.reject-btn:hover { background:#b93b3b; }
.btn { width:100%; max-width:400px; display:block; margin:15px auto; padding:14px; border:none; border-radius:12px; font-size:16px; color:#fff; cursor:pointer; transition:0.3s; clear:both; }
.back-btn { background:#4da3ff; }
.back-btn:hover { background:#2274d4; }
/* LIGHT THEME OVERRIDES */
body.light { background:#f4f6ff; color:#1a1a1a; }
body.light .header { background:#dde3ff; color:#1a1a1a; }
body.light .job-card { background:#ffffff; color:#1a1a1a; }
body.light .job-info { color:#5b6270; }
body.light .accept-btn { background:#005dd1; }
body.light .reject-btn { background:#d9534f; }
body.light .accept-btn:hover { background:#0049a3; }
body.light .reject-btn:hover { background:#b13e3a; }
</style>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const theme = localStorage.getItem("theme") || "dark";
  if(theme === "light") document.body.classList.add("light");
  loadJobRequests();
});

function loadJobRequests() {
  const mobile = localStorage.getItem("active_user");
  const requests = JSON.parse(localStorage.getItem("job_requests_" + mobile) || "[]");
  const container = document.getElementById("jobs");
  container.innerHTML = "";

  if(!requests.length) {
    container.innerHTML = "<p>No job requests at the moment.</p>";
    return;
  }

  requests.forEach(job => {
    const div = document.createElement("div");
    div.className = "job-card";
    div.innerHTML = `
      <div class="job-title">${job.title}</div>
      <div class="job-info">Location: ${job.location}, Date: ${job.date}</div>
      <button class="accept-btn" onclick="acceptJob('${job.id}')">Accept</button>
      <button class="reject-btn" onclick="rejectJob('${job.id}')">Reject</button>
    `;
    container.appendChild(div);
  });
}

function acceptJob(jobId) {
  const mobile = localStorage.getItem("active_user");
  let requests = JSON.parse(localStorage.getItem("job_requests_" + mobile) || "[]");
  let inprogress = JSON.parse(localStorage.getItem("jobs_inprogress_" + mobile) || "[]");

  const job = requests.find(j => j.id === jobId);
  if(job) {
    inprogress.push(job);
    requests = requests.filter(j => j.id !== jobId);
  }

  localStorage.setItem("job_requests_" + mobile, JSON.stringify(requests));
  localStorage.setItem("jobs_inprogress_" + mobile, JSON.stringify(inprogress));

  loadJobRequests();
}

function rejectJob(jobId) {
  const mobile = localStorage.getItem("active_user");
  let requests = JSON.parse(localStorage.getItem("job_requests_" + mobile) || "[]");
  requests = requests.filter(j => j.id !== jobId);
  localStorage.setItem("job_requests_" + mobile, JSON.stringify(requests));
  loadJobRequests();
}

function goToDashboard() {
  window.location.href="worker-dashboard.html";
}
</script>

</head>

<body>
  <div class="header">Job Requests</div>
  <div class="container" id="jobs"></div>
  <button class="btn back-btn" onclick="goToDashboard()">Back to Dashboard</button>
</body>
</html>
